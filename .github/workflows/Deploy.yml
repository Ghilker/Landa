name: Deploy via ftp
on: push
jobs:
  deploy:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Install sed
      run: sudo apt-get update && sudo apt-get install -y sed
    - name: Replace Username
      run: sed -i 's/_DATABASE_USERNAME_/${{ secrets._DATABASE_USERNAME_ }}/g' $GITHUB_WORKSPACE/config.inc.php
    - name: Replace Password
      run: sed -i 's/_DATABASE_PASSWORD_/${{ secrets._DATABASE_PASSWORD_ }}/g' $GITHUB_WORKSPACE/config.inc.php
      
    - name: reset package-lock.json
      run: git checkout package-lock.json
      
    - name: FTP Deploy
      # You may pin to the exact commit or the version.
      # uses: SamKirkland/FTP-Deploy-Action@6647c2f8ad10f869fded8e5a6253c9da11d7fb47
      uses: SamKirkland/FTP-Deploy-Action@3.1.2
      with:
        # Deployment destination server & path. Formatted as protocol://domain.com:port/full/destination/path/
        ftp-server: ${{ secrets.FTP_SERVER }}
        # FTP account username
        ftp-username: ${{ secrets.FTP_USERNAME }}
        # FTP account password
        ftp-password: ${{ secrets.FTP_PASSWORD }}
